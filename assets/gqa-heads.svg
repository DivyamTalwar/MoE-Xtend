<svg width="1200" height="420" viewBox="0 0 1200 420" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#F8FAFC" />
      <stop offset="45%" stop-color="#E0F2FE" />
      <stop offset="100%" stop-color="#FCE7F3" />
    </linearGradient>
    <linearGradient id="accent" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#06B6D4" />
      <stop offset="50%" stop-color="#8B5CF6" />
      <stop offset="100%" stop-color="#EC4899" />
    </linearGradient>
    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#CBD5E1" stroke-width="1" />
    </pattern>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="8" stdDeviation="8" flood-color="#0B1220" flood-opacity="0.12" />
    </filter>
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur in="SourceGraphic" stdDeviation="5" result="b" />
      <feColorMatrix in="b" type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 0.6 0" result="g" />
      <feMerge>
        <feMergeNode in="g" />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    <linearGradient id="scan" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#FFFFFF" stop-opacity="0" />
      <stop offset="50%" stop-color="#FFFFFF" stop-opacity="0.35" />
      <stop offset="100%" stop-color="#FFFFFF" stop-opacity="0" />
    </linearGradient>
  </defs>

  <rect width="1200" height="420" fill="url(#bg)" />
  <rect width="1200" height="420" fill="url(#grid)" opacity="0.22" />

  <text x="60" y="66" fill="#0B1220" font-size="28" font-weight="800" font-family="Space Grotesk, Helvetica, Arial, sans-serif">Grouped Query Attention (GQA): Head Grouping</text>
  <text x="60" y="98" fill="#334155" font-size="14" font-family="JetBrains Mono, 'Courier New', monospace">Many Q heads share fewer KV heads. group_size = H_q / H_kv. Bandwidth drops while Q diversity stays high.</text>
  <rect x="60" y="118" width="1080" height="6" fill="url(#accent)" />

  <!-- main card -->
  <g filter="url(#shadow)">
    <rect x="60" y="140" width="1080" height="240" rx="18" fill="#FFFFFF" opacity="0.66" stroke="#0B1220" stroke-width="2" />
  </g>

  <!-- labels -->
  <g font-family="JetBrains Mono, 'Courier New', monospace" fill="#0B1220">
    <text x="90" y="176" font-size="14" font-weight="800">Q heads (H_q)</text>
    <text x="640" y="176" font-size="14" font-weight="800">KV heads (H_kv)</text>
    <text x="90" y="206" font-size="12" fill="#334155">example: H_q=32, H_kv=8 -> group_size=4</text>
  </g>

  <!-- Q head grid: 8 columns x 4 rows (32 heads). Each column maps to one KV head. -->
  <g id="qgrid" transform="translate(110, 232)" stroke="#0B1220" stroke-width="1">
    <rect x="0" y="0" width="392" height="128" rx="14" fill="#F1F5F9" stroke="#0B1220" stroke-width="2" />

    <!-- highlight sweeps across columns -->
    <rect x="16" y="14" width="42" height="100" rx="10" fill="url(#accent)" opacity="0.18" filter="url(#glow)">
      <animate attributeName="x" values="16;316;16" dur="4.6s" repeatCount="indefinite" keyTimes="0;0.5;1" calcMode="spline" keySplines="0.42 0 0.58 1;0.42 0 0.58 1" />
    </rect>

    <g fill="#E2E8F0">
      <!-- 8 columns, 4 rows -->
      <rect x="16" y="14" width="32" height="18" rx="4" />
      <rect x="16" y="38" width="32" height="18" rx="4" />
      <rect x="16" y="62" width="32" height="18" rx="4" />
      <rect x="16" y="86" width="32" height="18" rx="4" />

      <rect x="60" y="14" width="32" height="18" rx="4" />
      <rect x="60" y="38" width="32" height="18" rx="4" />
      <rect x="60" y="62" width="32" height="18" rx="4" />
      <rect x="60" y="86" width="32" height="18" rx="4" />

      <rect x="104" y="14" width="32" height="18" rx="4" />
      <rect x="104" y="38" width="32" height="18" rx="4" />
      <rect x="104" y="62" width="32" height="18" rx="4" />
      <rect x="104" y="86" width="32" height="18" rx="4" />

      <rect x="148" y="14" width="32" height="18" rx="4" />
      <rect x="148" y="38" width="32" height="18" rx="4" />
      <rect x="148" y="62" width="32" height="18" rx="4" />
      <rect x="148" y="86" width="32" height="18" rx="4" />

      <rect x="192" y="14" width="32" height="18" rx="4" />
      <rect x="192" y="38" width="32" height="18" rx="4" />
      <rect x="192" y="62" width="32" height="18" rx="4" />
      <rect x="192" y="86" width="32" height="18" rx="4" />

      <rect x="236" y="14" width="32" height="18" rx="4" />
      <rect x="236" y="38" width="32" height="18" rx="4" />
      <rect x="236" y="62" width="32" height="18" rx="4" />
      <rect x="236" y="86" width="32" height="18" rx="4" />

      <rect x="280" y="14" width="32" height="18" rx="4" />
      <rect x="280" y="38" width="32" height="18" rx="4" />
      <rect x="280" y="62" width="32" height="18" rx="4" />
      <rect x="280" y="86" width="32" height="18" rx="4" />

      <rect x="324" y="14" width="32" height="18" rx="4" />
      <rect x="324" y="38" width="32" height="18" rx="4" />
      <rect x="324" y="62" width="32" height="18" rx="4" />
      <rect x="324" y="86" width="32" height="18" rx="4" />
    </g>

    <!-- pulse one group -->
    <g filter="url(#glow)">
      <rect x="148" y="14" width="32" height="90" rx="8" fill="url(#accent)" opacity="0.0">
        <animate attributeName="opacity" values="0;0.45;0" dur="2.4s" repeatCount="indefinite" />
      </rect>
    </g>
  </g>

  <!-- KV heads row -->
  <g id="kv" transform="translate(640, 248)" font-family="JetBrains Mono, 'Courier New', monospace" stroke="#0B1220" stroke-width="1">
    <rect x="0" y="0" width="480" height="100" rx="14" fill="#F1F5F9" stroke="#0B1220" stroke-width="2" />
    <g>
      <rect x="16" y="26" width="48" height="48" rx="10" fill="#BAE6FD" opacity="0.9" />
      <rect x="72" y="26" width="48" height="48" rx="10" fill="#DDD6FE" opacity="0.9" />
      <rect x="128" y="26" width="48" height="48" rx="10" fill="#FBCFE8" opacity="0.9" />
      <rect x="184" y="26" width="48" height="48" rx="10" fill="#BAE6FD" opacity="0.9" />
      <rect x="240" y="26" width="48" height="48" rx="10" fill="#DDD6FE" opacity="0.9" />
      <rect x="296" y="26" width="48" height="48" rx="10" fill="#FBCFE8" opacity="0.9" />
      <rect x="352" y="26" width="48" height="48" rx="10" fill="#BAE6FD" opacity="0.9" />
      <rect x="408" y="26" width="48" height="48" rx="10" fill="#DDD6FE" opacity="0.9" />
    </g>

    <g font-size="11" fill="#334155">
      <text x="18" y="92">KV0</text>
      <text x="74" y="92">KV1</text>
      <text x="130" y="92">KV2</text>
      <text x="186" y="92">KV3</text>
      <text x="242" y="92">KV4</text>
      <text x="298" y="92">KV5</text>
      <text x="354" y="92">KV6</text>
      <text x="410" y="92">KV7</text>
    </g>

    <g filter="url(#glow)">
      <rect x="184" y="26" width="48" height="48" rx="10" fill="url(#accent)" opacity="0.0">
        <animate attributeName="opacity" values="0;0.5;0" dur="2.4s" repeatCount="indefinite" />
      </rect>
    </g>
  </g>

  <!-- mapping lines (column centers -> kv centers) -->
  <g stroke="#0B1220" stroke-width="2" opacity="0.55" fill="none">
    <line x1="142" y1="296" x2="680" y2="302" />
    <line x1="186" y1="296" x2="736" y2="302" />
    <line x1="230" y1="296" x2="792" y2="302" />
    <line x1="274" y1="296" x2="848" y2="302" />
    <line x1="318" y1="296" x2="904" y2="302" />
    <line x1="362" y1="296" x2="960" y2="302" />
    <line x1="406" y1="296" x2="1016" y2="302" />
    <line x1="450" y1="296" x2="1072" y2="302" />
  </g>

  <!-- scanline across card -->
  <rect x="60" y="140" width="1080" height="34" fill="url(#scan)" opacity="0.22">
    <animate attributeName="y" dur="6.2s" repeatCount="indefinite" values="140;352;140" keyTimes="0;0.5;1" calcMode="spline" keySplines="0.42 0 0.58 1;0.42 0 0.58 1" />
  </rect>

  <g font-family="JetBrains Mono, 'Courier New', monospace" font-size="12" fill="#334155">
    <text x="60" y="414">intuition: Q has many heads for expressivity; KV is shared to reduce KV cache size + bandwidth.</text>
  </g>
</svg>
